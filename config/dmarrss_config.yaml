# DMARRSS Configuration File
system:
  name: "DMARRSS"
  version: "1.0.0"
  mode: "decentralized"  # Options: centralized_cloud, centralized_onprem, decentralized
  enforce: false  # Set via DMARRSS_ENFORCE env var; default: dry-run only
  data_dir: "./data"

# Log ingestion configuration
ingest:
  snort:
    enabled: true
    files: ["./data/raw/sample_snort_alerts.log"]
  suricata:
    enabled: true
    files: ["./data/raw/sample_suricata_eve.json"]
  zeek:
    enabled: true
    files: ["./data/raw/sample_zeek_conn.log"]

# Severity thresholds for Context Aware Event Severity Layers
severity_layers:
  layer1:  # Primary context layer
    critical: 0.90
    high: 0.70
    medium: 0.50
    low: 0.30
  
  layer2:  # Secondary risk layer
    critical: 0.90
    high: 0.70
    medium: 0.50
    low: 0.30

# Threat scoring configuration
scoring:
  weights:
    pattern_match: 0.30
    context_relevance: 0.25
    historical_severity: 0.20
    source_reputation: 0.15
    anomaly_score: 0.10
  cidr_include: ["10.0.0.0/8", "192.168.0.0/16"]
  reputation_csv: "./data/reputation/reputation.csv"

# Response actions mapping by severity
responses:
  CRITICAL: ["block_ip", "notify_webhook"]
  HIGH: ["notify_webhook"]
  MEDIUM: ["notify_webhook"]
  LOW: []

# API configuration
api:
  host: "0.0.0.0"
  port: 8080
  metrics: true

# Neural network configuration for LLM-inspired processing
neural_config:
  embedding_dim: 128
  hidden_layers: [256, 128, 64]
  dropout_rate: 0.3
  learning_rate: 0.001
  batch_size: 32

# Logging configuration
logging:
  level: "INFO"
  file: "logs/dmarrss.log"
  format: "json"
