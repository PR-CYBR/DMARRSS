# DMARRSS Configuration File
system:
  name: "DMARRSS"
  version: "1.0.0"
  mode: "decentralized"  # Options: centralized_cloud, centralized_onprem, decentralized
  enforce: false  # Set via DMARRSS_ENFORCE env var; default: dry-run only
  data_dir: "./data"

# Log ingestion configuration
ingest:
  snort:
    enabled: true
    files: ["./data/raw/sample_snort_alerts.log"]
  suricata:
    enabled: true
    files: ["./data/raw/sample_suricata_eve.json"]
  zeek:
    enabled: true
    files: ["./data/raw/sample_zeek_conn.log"]

# Severity thresholds for Context Aware Event Severity Layers
severity_layers:
  layer1:  # Primary context layer
    critical: 0.90
    high: 0.70
    medium: 0.50
    low: 0.30
  
  layer2:  # Secondary risk layer
    critical: 0.90
    high: 0.70
    medium: 0.50
    low: 0.30

# Threat scoring configuration
scoring:
  weights:
    pattern_match: 0.30
    context_relevance: 0.25
    historical_severity: 0.20
    source_reputation: 0.15
    anomaly_score: 0.10
  cve_weight: 0.30  # Weight for CVSS score contribution
  cve_cache_file: "./data/cache/cve_cache.json"
  cve_timeout: 10.0  # seconds
  cve_cache_ttl_hours: 24
  cidr_include: ["10.0.0.0/8", "192.168.0.0/16"]
  reputation_csv: "./data/reputation/reputation.csv"

# Response actions mapping by severity
responses:
  CRITICAL: ["block_ip", "notify_webhook"]
  HIGH: ["notify_webhook"]
  MEDIUM: ["notify_webhook"]
  LOW: []

# API configuration
api:
  host: "0.0.0.0"
  port: 8080
  metrics: true

# Neural network configuration for LLM-inspired processing
neural_config:
  embedding_dim: 128
  hidden_layers: [256, 128, 64]
  dropout_rate: 0.3
  learning_rate: 0.001
  batch_size: 32

# Logging configuration
logging:
  level: "INFO"
  file: "logs/dmarrss.log"
  format: "json"

# NIST CSF 2.0 Configuration
csf:
  # Asset Inventory (IDENTIFY function)
  asset_inventory:
    enabled: true
    auto_collect_on_start: true
    
  # Security Baseline (PROTECT function)
  security_baseline:
    enabled: true
    auto_check_on_start: false
    
  # Anomaly Detection (DETECT function)
  anomaly_detection:
    enabled: true
    process_threshold: 0.2  # 20% deviation threshold
    network_threshold: 0.3  # 30% deviation threshold
    user_threshold: 0.5     # 50% deviation threshold
    
  # Threat Intelligence (DETECT function)
  threat_intel:
    enabled: true
    update_interval_hours: 24
    feeds:
      # Example custom feed configuration
      # custom_feed:
      #   enabled: false
      #   type: "file"  # or "url"
      #   path: "./data/threat_feeds/custom.json"
      
  # Recovery (RECOVER function)
  recovery:
    enabled: true
    auto_backup_before_changes: true
    create_restore_points: false  # Windows only
    
  # CSF Reporting (GOVERN function)
  reporting:
    enabled: true
    auto_generate_on_complete: true
